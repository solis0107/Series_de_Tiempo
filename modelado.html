<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Modelado | Análisis de Series de Tiempo</title>
  <meta name="description" content="En este documento se desarrolla el análisis de una serie de tiempo del patron de arrivo de contactos en una linea de atención telefonica, en el marco de la asignatura Análisis de Series de tiempo de la mestria de Ciencia de Datos, Universidad Javeriana Cali." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Modelado | Análisis de Series de Tiempo" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="En este documento se desarrolla el análisis de una serie de tiempo del patron de arrivo de contactos en una linea de atención telefonica, en el marco de la asignatura Análisis de Series de tiempo de la mestria de Ciencia de Datos, Universidad Javeriana Cali." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Modelado | Análisis de Series de Tiempo" />
  
  <meta name="twitter:description" content="En este documento se desarrolla el análisis de una serie de tiempo del patron de arrivo de contactos en una linea de atención telefonica, en el marco de la asignatura Análisis de Series de tiempo de la mestria de Ciencia de Datos, Universidad Javeriana Cali." />
  

<meta name="author" content="Johnattan Solis" />


<meta name="date" content="2023-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="análisis-de-descriptivo-y-transformaciones.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de Serie de Tiempo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#descripción-del-documento"><i class="fa fa-check"></i><b>1.1</b> Descripción del documento</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#justificación-del-documento"><i class="fa fa-check"></i><b>1.2</b> Justificación del documento</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="requerimientos.html"><a href="requerimientos.html"><i class="fa fa-check"></i><b>2</b> Requerimientos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="requerimientos.html"><a href="requerimientos.html#instalación-de-librerias"><i class="fa fa-check"></i><b>2.1</b> Instalación de librerias</a></li>
<li class="chapter" data-level="2.2" data-path="requerimientos.html"><a href="requerimientos.html#importe-de-los-datos"><i class="fa fa-check"></i><b>2.2</b> Importe de los datos</a></li>
<li class="chapter" data-level="2.3" data-path="requerimientos.html"><a href="requerimientos.html#formato"><i class="fa fa-check"></i><b>2.3</b> Formato</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html"><i class="fa fa-check"></i><b>3</b> Análisis de descriptivo y transformaciones</a>
<ul>
<li class="chapter" data-level="3.1" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#visualización-inicial"><i class="fa fa-check"></i><b>3.1</b> Visualización Inicial</a></li>
<li class="chapter" data-level="3.2" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#parametros-de-la-seire-de-tiempo"><i class="fa fa-check"></i><b>3.2</b> Parametros de la seire de tiempo</a></li>
<li class="chapter" data-level="3.3" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#descomponsición-de-la-serie"><i class="fa fa-check"></i><b>3.3</b> Descomponsición de la serie</a></li>
<li class="chapter" data-level="3.4" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#analisis-de-tendencia"><i class="fa fa-check"></i><b>3.4</b> Analisis de Tendencia</a></li>
<li class="chapter" data-level="3.5" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#analisis-de-estacionalidad"><i class="fa fa-check"></i><b>3.5</b> Analisis de Estacionalidad</a></li>
<li class="chapter" data-level="3.6" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#análisis-de-estacionariedad"><i class="fa fa-check"></i><b>3.6</b> Análisis de estacionariedad</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#análisis-de-rezagos"><i class="fa fa-check"></i><b>3.6.1</b> Análisis de rezagos</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="análisis-de-descriptivo-y-transformaciones.html"><a href="análisis-de-descriptivo-y-transformaciones.html#tranformación-diferenciación"><i class="fa fa-check"></i><b>3.7</b> Tranformación (Diferenciación)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelado.html"><a href="modelado.html"><i class="fa fa-check"></i><b>4</b> Modelado</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelado.html"><a href="modelado.html#regresión-lineal"><i class="fa fa-check"></i><b>4.1</b> Regresión Lineal</a></li>
<li class="chapter" data-level="4.2" data-path="modelado.html"><a href="modelado.html#suavisamiento-exponencial-simple"><i class="fa fa-check"></i><b>4.2</b> Suavisamiento Exponencial Simple</a></li>
<li class="chapter" data-level="4.3" data-path="modelado.html"><a href="modelado.html#suavisamiento-exponencial-triple-holt-winters"><i class="fa fa-check"></i><b>4.3</b> Suavisamiento Exponencial Triple (Holt-Winters)</a></li>
<li class="chapter" data-level="4.4" data-path="modelado.html"><a href="modelado.html#modelo-arima"><i class="fa fa-check"></i><b>4.4</b> Modelo ARIMA</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="modelado.html"><a href="modelado.html#analisis-de-residuales-en-modelo-arima"><i class="fa fa-check"></i><b>4.4.1</b> Analisis de residuales en modelo Arima</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="modelado.html"><a href="modelado.html#modelo-prohet"><i class="fa fa-check"></i><b>4.5</b> Modelo PROHET</a></li>
<li class="chapter" data-level="4.6" data-path="modelado.html"><a href="modelado.html#modelo-redes-neuronales-de-elman-y-jordan"><i class="fa fa-check"></i><b>4.6</b> Modelo Redes Neuronales de Elman y Jordan</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="modelado.html"><a href="modelado.html#normalizar-la-serie-de-tiempo"><i class="fa fa-check"></i><b>4.6.1</b> Normalizar la Serie de tiempo</a></li>
<li class="chapter" data-level="4.6.2" data-path="modelado.html"><a href="modelado.html#definir-train-set-y-test-set"><i class="fa fa-check"></i><b>4.6.2</b> Definir Train Set y Test Set</a></li>
<li class="chapter" data-level="4.6.3" data-path="modelado.html"><a href="modelado.html#creación-de-secuencias"><i class="fa fa-check"></i><b>4.6.3</b> Creación de Secuencias</a></li>
<li class="chapter" data-level="4.6.4" data-path="modelado.html"><a href="modelado.html#diseño-de-la-arquitectura-de-la-red"><i class="fa fa-check"></i><b>4.6.4</b> Diseño de la arquitectura de la red</a></li>
<li class="chapter" data-level="4.6.5" data-path="modelado.html"><a href="modelado.html#entrenamiento-de-la-red"><i class="fa fa-check"></i><b>4.6.5</b> Entrenamiento de la red</a></li>
<li class="chapter" data-level="4.6.6" data-path="modelado.html"><a href="modelado.html#validación-y-ajuste-de-hiperparámetros"><i class="fa fa-check"></i><b>4.6.6</b> Validación y ajuste de hiperparámetros</a></li>
<li class="chapter" data-level="4.6.7" data-path="modelado.html"><a href="modelado.html#modelo-red-neuronal-de-jordan"><i class="fa fa-check"></i><b>4.6.7</b> Modelo Red neuronal de Jordan</a></li>
<li class="chapter" data-level="4.6.8" data-path="modelado.html"><a href="modelado.html#entrenamiento-del-modelo"><i class="fa fa-check"></i><b>4.6.8</b> Entrenamiento del modelo</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de Series de Tiempo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelado" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Modelado<a href="modelado.html#modelado" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="regresión-lineal" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Regresión Lineal<a href="modelado.html#regresión-lineal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analicemos el modelado de esta serie de tiempo con una regresión lineal; si bien, la regresión no va a ser util para modelar esta serie de tiempo, nos dará una vista general de la tendencia de los datos.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="modelado.html#cb55-1" tabindex="-1"></a><span class="fu">plot</span>(serie_tiempo)</span>
<span id="cb55-2"><a href="modelado.html#cb55-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">reg =</span> <span class="fu">lm</span>(serie_tiempo <span class="sc">~</span> <span class="fu">time</span>(serie_tiempo)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="suavisamiento-exponencial-simple" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Suavisamiento Exponencial Simple<a href="modelado.html#suavisamiento-exponencial-simple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>el suavisamiento exponencial es especialmente útil cuando se trabaja con datos que muestran tendencias y patrones suaves, pero no poseen patrones estacionales o cíclicos pronunciados. Dado que nuestra serie presenta una fuerte estacionalidad, no se espera que este método genere un buen ajuste a la serie. Analicemos su comportamiento:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="modelado.html#cb56-1" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<pre><code>## Registered S3 methods overwritten by &#39;forecast&#39;:
##   method                 from     
##   autoplot.Arima         ggfortify
##   autoplot.acf           ggfortify
##   autoplot.ar            ggfortify
##   autoplot.bats          ggfortify
##   autoplot.decomposed.ts ggfortify
##   autoplot.ets           ggfortify
##   autoplot.forecast      ggfortify
##   autoplot.stl           ggfortify
##   autoplot.ts            ggfortify
##   fitted.ar              ggfortify
##   fortify.ts             ggfortify
##   residuals.ar           ggfortify</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="modelado.html#cb58-1" tabindex="-1"></a>fcast_ses <span class="ot">&lt;-</span> <span class="fu">ses</span>(serie_tiempo, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb58-2"><a href="modelado.html#cb58-2" tabindex="-1"></a><span class="fu">autoplot</span>(fcast_ses) <span class="sc">+</span> <span class="fu">autolayer</span>(<span class="fu">fitted</span>(fcast_ses), <span class="at">series=</span><span class="st">&quot;Fitted&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Como era de esperarse, el suavisamiento exponencial simple no logra seguir la fuerte estacionalidad que tiene la serie de tiempo.</p>
</div>
<div id="suavisamiento-exponencial-triple-holt-winters" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Suavisamiento Exponencial Triple (Holt-Winters)<a href="modelado.html#suavisamiento-exponencial-triple-holt-winters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A continuación analizaremos el comportamiento del modelado Hold-Winters en la serie de tiempo, como se habia provado anteriormente, esta serie tiene estacionalidad y tendencia, por lo que se espera tener buenos resultados con este modelo.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="modelado.html#cb59-1" tabindex="-1"></a>mod1 <span class="ot">=</span>  <span class="fu">HoltWinters</span>(serie_tiempo, <span class="at">seasonal =</span> <span class="st">&quot;additive&quot;</span>)</span>
<span id="cb59-2"><a href="modelado.html#cb59-2" tabindex="-1"></a><span class="fu">plot</span>(mod1)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>De forma general, se puede ver un buen ajuste del modelo a los datos, no solo en la tendencia que estos llevan sino también en la fuerte estacionalidad que tiene la serie de tiempo. El modelo es capaz de respetar tanto los</p>
</div>
<div id="modelo-arima" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Modelo ARIMA<a href="modelado.html#modelo-arima" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como lo hemos visto en el analisis descriptivo y en el modelado de regresión lineal, nuestra serie no es estacionaria, al intentar utilizar un modelo ARIMA se debe garantizar que la serie de tiempo es estacionaria. Para esto se realizará una transformación a la serie para lograr que esta sea estacionaria utilizando la función adf.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="modelado.html#cb60-1" tabindex="-1"></a><span class="fu">library</span>(aTSA)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;aTSA&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:forecast&#39;:
## 
##     forecast</code></pre>
<pre><code>## The following objects are masked from &#39;package:tseries&#39;:
## 
##     adf.test, kpss.test, pp.test</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     identify</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="modelado.html#cb65-1" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">diff</span>(serie_tiempo))</span></code></pre></div>
<pre><code>## Augmented Dickey-Fuller Test 
## alternative: stationary 
##  
## Type 1: no drift no trend 
##      lag   ADF p.value
## [1,]   0 -22.7    0.01
## [2,]   1 -19.0    0.01
## [3,]   2 -16.0    0.01
## [4,]   3 -14.2    0.01
## [5,]   4 -18.8    0.01
## [6,]   5 -26.9    0.01
## Type 2: with drift no trend 
##      lag   ADF p.value
## [1,]   0 -22.7    0.01
## [2,]   1 -19.0    0.01
## [3,]   2 -16.0    0.01
## [4,]   3 -14.2    0.01
## [5,]   4 -18.8    0.01
## [6,]   5 -26.9    0.01
## Type 3: with drift and trend 
##      lag   ADF p.value
## [1,]   0 -22.7    0.01
## [2,]   1 -19.0    0.01
## [3,]   2 -15.9    0.01
## [4,]   3 -14.2    0.01
## [5,]   4 -18.7    0.01
## [6,]   5 -26.9    0.01
## ---- 
## Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
<p>Con este resultado confirmamos que la serie ya se encuentra estacionaria.</p>
<p>Encontramos los parametros ARIMA de la serie de tiempo utilizando la funcion auto.arima</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="modelado.html#cb67-1" tabindex="-1"></a>modelo<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(<span class="fu">diff</span>(serie_tiempo),  <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="modelado.html#cb68-1" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## Series: diff(serie_tiempo) 
## ARIMA(3,0,2) with zero mean 
## 
## Coefficients:
##          ar1      ar2      ar3      ma1     ma2
##       0.8245  -0.4386  -0.2411  -1.5124  0.7799
## s.e.  0.0690   0.0690   0.0623   0.0464  0.0477
## 
## sigma^2 = 3395:  log likelihood = -1764.57
## AIC=3541.14   AICc=3541.4   BIC=3563.78
## 
## Training set error measures:
##                      ME     RMSE      MAE      MPE     MAPE      MASE
## Training set -0.3987745 57.81435 46.44426 68.63847 210.5593 0.9619898
##                     ACF1
## Training set -0.04708994</code></pre>
<p>Utilizando estos parametros para hacer predicciones en el modelo</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="modelado.html#cb70-1" tabindex="-1"></a>modelo_arima <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="fu">diff</span>(serie_tiempo), <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb70-2"><a href="modelado.html#cb70-2" tabindex="-1"></a></span>
<span id="cb70-3"><a href="modelado.html#cb70-3" tabindex="-1"></a>n_predicciones <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb70-4"><a href="modelado.html#cb70-4" tabindex="-1"></a>predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_arima, <span class="at">n.ahead =</span> n_predicciones)</span>
<span id="cb70-5"><a href="modelado.html#cb70-5" tabindex="-1"></a></span>
<span id="cb70-6"><a href="modelado.html#cb70-6" tabindex="-1"></a><span class="co"># Visualiza las predicciones</span></span>
<span id="cb70-7"><a href="modelado.html#cb70-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(serie_tiempo) , <span class="at">main =</span> <span class="st">&quot;Serie Temporal y Predicciones&quot;</span>)</span>
<span id="cb70-8"><a href="modelado.html#cb70-8" tabindex="-1"></a><span class="fu">lines</span>(predicciones<span class="sc">$</span>pred, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># Línea de predicciones</span></span>
<span id="cb70-9"><a href="modelado.html#cb70-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;Predicciones&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Veamos el ajuste del modelo a la serie de tiempo:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="modelado.html#cb71-1" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb71-2"><a href="modelado.html#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="modelado.html#cb71-3" tabindex="-1"></a><span class="co"># Graficar la serie de tiempo original</span></span>
<span id="cb71-4"><a href="modelado.html#cb71-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(serie_tiempo), <span class="at">main =</span> <span class="st">&quot;Serie Temporal vs. Modelo ARIMA&quot;</span>)</span>
<span id="cb71-5"><a href="modelado.html#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="modelado.html#cb71-6" tabindex="-1"></a><span class="co"># Agregar las predicciones del modelo ARIMA al gráfico</span></span>
<span id="cb71-7"><a href="modelado.html#cb71-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(modelo_arima), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,  <span class="at">lwd =</span> <span class="fl">0.5</span>)  <span class="co"># Línea de predicciones</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>La serie logra captar los patrones de estacionariedad, se confirma nuevamente que la serie quedo estacionaria, no se evidencian patrones de tendencia en el comportamiento de esta. Si bien aún no podemos definir que modelo se ajustó mejor porque no hemos definido medidas de desempeño, pero para la serie sin tendencia este parece tener un buen ajuste.</p>
<div id="analisis-de-residuales-en-modelo-arima" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Analisis de residuales en modelo Arima<a href="modelado.html#analisis-de-residuales-en-modelo-arima" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para que el modelo pueda ser utilizado se debe garantizar que este tiene ruido blanco, por lo que haremos verificaciones de normalidad, independencia y homocedasticidad y media cero en los errores.</p>
<div id="normalidad" class="section level4 hasAnchor" number="4.4.1.1">
<h4><span class="header-section-number">4.4.1.1</span> Normalidad<a href="modelado.html#normalidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ho: Los errores distribuyen normal
H1: Los errores no distribuyen normal</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="modelado.html#cb72-1" tabindex="-1"></a>residuales<span class="ot">&lt;-</span>modelo_arima<span class="sc">$</span>residuals</span>
<span id="cb72-2"><a href="modelado.html#cb72-2" tabindex="-1"></a><span class="fu">qqnorm</span>(residuales)</span>
<span id="cb72-3"><a href="modelado.html#cb72-3" tabindex="-1"></a><span class="fu">qqline</span>(residuales)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="modelado.html#cb73-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(residuales)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuales
## W = 0.99528, p-value = 0.4369</code></pre>
<p>Con un nivel de significancia de 0.05 no se puede concluir que los errores no siguen una distribución normal. Esto se reafirma en la grafica, la cual muestra un comportamiento muy señido a la linea de normalidad.</p>
</div>
<div id="homocedastidad-y-media-cero" class="section level4 hasAnchor" number="4.4.1.2">
<h4><span class="header-section-number">4.4.1.2</span> Homocedastidad y media cero<a href="modelado.html#homocedastidad-y-media-cero" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="modelado.html#cb75-1" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(modelo_arima))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Del análisis visual que nos da gráfica, se puede concluir que los errores si están centrados en cero pero estos no tienen una varianza constante, por lo que existe heterocedastidad.</p>
</div>
<div id="independencia" class="section level4 hasAnchor" number="4.4.1.3">
<h4><span class="header-section-number">4.4.1.3</span> Independencia<a href="modelado.html#independencia" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ho: Los residuo son independientes
H1: Los residuos son dependientes</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="modelado.html#cb76-1" tabindex="-1"></a><span class="fu">Box.test</span>(residuales,<span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  residuales
## X-squared = 0.72194, df = 1, p-value = 0.3955</code></pre>
<p>A un nivel de significancia de 0.05 no se puede concluir que los residuos no son independientes.</p>
<p>Si bien la mayoria de los supuestos se cumplen, los residuos presentan heterosedasticisas, su varianza varia en el tiempo, por lo que no se puede decir que le modelo presenta ruido blanco.</p>
</div>
</div>
</div>
<div id="modelo-prohet" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Modelo PROHET<a href="modelado.html#modelo-prohet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dado que nuesta serie de tiempo presenta una fuerte estacionalidad semanal y que la tendencia es un factor a considerar en ella, el algortimo prohet de facebook podría mostrar resultados interesantes. Analicemos el pronostico ajustando este algoritmo a la serie de tiempo:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="modelado.html#cb78-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;prophet&quot;</span>)</span></code></pre></div>
<pre><code>## The following package(s) will be installed:
## 
## - prophet [1.0]
## 
## These packages will be installed into &quot;C:/Users/JSOLISP/OneDrive - TCC/Escritorio/PERSN/Universidad/Series_de_tiempo/PROYECTO_BOOKDOWN/renv/library/R-4.3/x86_64-w64-mingw32&quot;.
## 
## # Installing packages --------------------------------------------------------
## 
## - Installing prophet ...                        OK [linked from cache in 0.0013s]
## 
## Successfully installed 1 package in 15 milliseconds.</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="modelado.html#cb80-1" tabindex="-1"></a><span class="fu">library</span>(prophet)</span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## Loading required package: rlang</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="modelado.html#cb83-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb83-2"><a href="modelado.html#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="modelado.html#cb83-3" tabindex="-1"></a></span>
<span id="cb83-4"><a href="modelado.html#cb83-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ds =</span> datos<span class="sc">$</span>Date, <span class="at">y =</span> datos<span class="sc">$</span>Volume)</span>
<span id="cb83-5"><a href="modelado.html#cb83-5" tabindex="-1"></a></span>
<span id="cb83-6"><a href="modelado.html#cb83-6" tabindex="-1"></a><span class="co"># Crear un objeto Prophet</span></span>
<span id="cb83-7"><a href="modelado.html#cb83-7" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">prophet</span>(data, <span class="at">daily.seasonality=</span><span class="cn">TRUE</span>, <span class="at">yearly.seasonality=</span><span class="cn">FALSE</span>)</span>
<span id="cb83-8"><a href="modelado.html#cb83-8" tabindex="-1"></a></span>
<span id="cb83-9"><a href="modelado.html#cb83-9" tabindex="-1"></a><span class="co"># Realizar las previsiones</span></span>
<span id="cb83-10"><a href="modelado.html#cb83-10" tabindex="-1"></a>future <span class="ot">&lt;-</span> <span class="fu">make_future_dataframe</span>(model, <span class="at">periods =</span> <span class="dv">4</span>) <span class="co"># &quot;n&quot; es el número de períodos a predecir</span></span>
<span id="cb83-11"><a href="modelado.html#cb83-11" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, future)</span>
<span id="cb83-12"><a href="modelado.html#cb83-12" tabindex="-1"></a></span>
<span id="cb83-13"><a href="modelado.html#cb83-13" tabindex="-1"></a><span class="co"># Visualizar los resultados</span></span>
<span id="cb83-14"><a href="modelado.html#cb83-14" tabindex="-1"></a><span class="fu">plot</span>(forecast)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="modelado.html#cb84-1" tabindex="-1"></a><span class="co"># Para ver la comparación entre los valores reales y las previsiones</span></span>
<span id="cb84-2"><a href="modelado.html#cb84-2" tabindex="-1"></a><span class="fu">plot</span>(model, forecast)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
<p>De forma general podemos decir que el algoritmo no presenta muy buen ajuste a nuestra serie de tiempo.</p>
</div>
<div id="modelo-redes-neuronales-de-elman-y-jordan" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Modelo Redes Neuronales de Elman y Jordan<a href="modelado.html#modelo-redes-neuronales-de-elman-y-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Apliquemos las redes neuronales de Elman y Jordan a nuestra serie de tiempo para analizar el comportamiento que esta tiene</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="modelado.html#cb85-1" tabindex="-1"></a>tsData <span class="ot">=</span> serie_tiempo</span>
<span id="cb85-2"><a href="modelado.html#cb85-2" tabindex="-1"></a><span class="fu">print</span>(tsData)</span></code></pre></div>
<pre><code>## Time Series:
## Start = c(19134, 1) 
## End = c(19180, 1) 
## Frequency = 7 
##   [1]  85 163 233 282 303 344 241  96 309 357 219 269 252 204 119 294 252 168
##  [19] 170 205 152  70 167 214 251 288 222 204  66 209 251 295 303 319 165 146
##  [37] 266 270 278 211 275 128 121 240 335 286 285 199 164 149 288 279 276 279
##  [55] 184 186 133 238 300 264 240 222 234  66 239 246 172 164 146 130  97 243
##  [73] 250 276 267 234 161 172 259 240 236 244 248 154 135 197 207 222 225 214
##  [91] 215 100 241 281 235 206 303 131 166 243 237 293 242 279 215 147 256 288
## [109] 266 288 311 171 149 339 342 326 235 271  98 200 302 337 272 216 293 202
## [127] 124 300 250 283 271 302 189 121 268 192 256 266 283 183 138 268 274 279
## [145] 190 233 100 144 259 270 242 209 244 127 146 250 246 232 248 223 105 138
## [163] 259 251 236 248 320 177 126 272 271 286 229 270 239 151 223 226 204 178
## [181] 190 162 149 223 209 219 179 216 171 118 239 269 242 166 203 152 137 217
## [199] 196 234 228 216 144  97 229 249 239 272 254 144 115 238 223 230 228 175
## [217] 119  97 258 223 224 219 162  74  53 204 223 259 216 204 185 127 226 249
## [235] 247 248 225 154 133 236 232 207 247 268 215 151 251 222 242 291 232 214
## [253]  84 232 287 184 277 287 212  84 300 302 272 310 316 243 107 303 291 396
## [271] 153 341 177 129 260 262 287 272 308 247 118 300 290 298 366 257 185  95
## [289] 220 180 203 250 193 102 106 132 172 161 193 168 120  96 240 217 241 238
## [307] 197 105 110 173 299 195 171 163 109  63 132 163 134 168 129  81  48</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="modelado.html#cb87-1" tabindex="-1"></a><span class="fu">plot</span>(tsData)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="modelado.html#cb88-1" tabindex="-1"></a><span class="fu">require</span>(RSNNS) </span></code></pre></div>
<pre><code>## Loading required package: RSNNS</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="modelado.html#cb90-1" tabindex="-1"></a><span class="fu">require</span>(quantmod)</span></code></pre></div>
<pre><code>## Loading required package: quantmod</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<div id="normalizar-la-serie-de-tiempo" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Normalizar la Serie de tiempo<a href="modelado.html#normalizar-la-serie-de-tiempo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Normalizar los datos es necesario para que tengan una escala similar. Esto puede ayudar a que la red neuronal converja más rápido y a obtener mejores resultados</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="modelado.html#cb97-1" tabindex="-1"></a>stsData<span class="ot">&lt;-</span><span class="fu">as.ts</span>(tsData,F)</span>
<span id="cb97-2"><a href="modelado.html#cb97-2" tabindex="-1"></a>stsDataN<span class="ot">&lt;-</span> (stsData<span class="sc">-</span><span class="fu">min</span>(stsData))<span class="sc">/</span>(<span class="fu">max</span>(stsData)<span class="sc">-</span><span class="fu">min</span>(stsData))</span>
<span id="cb97-3"><a href="modelado.html#cb97-3" tabindex="-1"></a><span class="fu">plot</span>(stsDataN)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="definir-train-set-y-test-set" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Definir Train Set y Test Set<a href="modelado.html#definir-train-set-y-test-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="modelado.html#cb98-1" tabindex="-1"></a>tamano_total <span class="ot">&lt;-</span> <span class="fu">length</span>(stsDataN)</span>
<span id="cb98-2"><a href="modelado.html#cb98-2" tabindex="-1"></a>tamano_total</span></code></pre></div>
<pre><code>## [1] 323</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="modelado.html#cb100-1" tabindex="-1"></a>tamano_train <span class="ot">&lt;-</span> <span class="fu">round</span>(tamano_total<span class="sc">*</span><span class="fl">0.75</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb100-2"><a href="modelado.html#cb100-2" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(tamano_train<span class="dv">-1</span>)</span>
<span id="cb100-3"><a href="modelado.html#cb100-3" tabindex="-1"></a>train</span></code></pre></div>
<pre><code>##   [1]   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
##  [19]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
##  [37]  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
##  [55]  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
##  [73]  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
##  [91]  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
## [109] 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
## [127] 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
## [145] 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
## [163] 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
## [181] 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
## [199] 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
## [217] 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233
## [235] 234 235 236 237 238 239 240 241</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="modelado.html#cb102-1" tabindex="-1"></a>test <span class="ot">&lt;-</span> (tamano_train)<span class="sc">:</span>tamano_total</span>
<span id="cb102-2"><a href="modelado.html#cb102-2" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>##  [1] 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260
## [20] 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279
## [39] 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298
## [58] 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317
## [77] 318 319 320 321 322 323</code></pre>
</div>
<div id="creación-de-secuencias" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Creación de Secuencias<a href="modelado.html#creación-de-secuencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El siguiente paso es convierte los datos de la serie de tiempo en secuencias. Esto implica dividir la serie de tiempo en segmentos más pequeños que se utilizarán como entradas y salidas de la red. En este caso como mi serie de tiempo es semanal, utilizare 7 lags.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="modelado.html#cb104-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.zoo</span>(stsDataN)</span>
<span id="cb104-2"><a href="modelado.html#cb104-2" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">1</span>) </span>
<span id="cb104-3"><a href="modelado.html#cb104-3" tabindex="-1"></a>x2<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">2</span>) </span>
<span id="cb104-4"><a href="modelado.html#cb104-4" tabindex="-1"></a>x3<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">3</span>) </span>
<span id="cb104-5"><a href="modelado.html#cb104-5" tabindex="-1"></a>x4<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">4</span>) </span>
<span id="cb104-6"><a href="modelado.html#cb104-6" tabindex="-1"></a>x5<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">5</span>) </span>
<span id="cb104-7"><a href="modelado.html#cb104-7" tabindex="-1"></a>x6<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">6</span>) </span>
<span id="cb104-8"><a href="modelado.html#cb104-8" tabindex="-1"></a>x7<span class="ot">=</span><span class="fu">lag</span>(y,<span class="at">k=</span><span class="dv">7</span>) </span>
<span id="cb104-9"><a href="modelado.html#cb104-9" tabindex="-1"></a>slogN <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x1,x2,x3,x4,x5,x6,x7)</span></code></pre></div>
</div>
<div id="diseño-de-la-arquitectura-de-la-red" class="section level3 hasAnchor" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Diseño de la arquitectura de la red<a href="modelado.html#diseño-de-la-arquitectura-de-la-red" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se retiras las filas con nulos</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="modelado.html#cb105-1" tabindex="-1"></a>slogN <span class="ot">&lt;-</span> slogN[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),]</span></code></pre></div>
<p>De esta forma ya no presentamos nulos en la red</p>
<p>Se definen los inputs y outputs, en este caso los 7 desfaces intentaran predecir la serie real</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="modelado.html#cb106-1" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> slogN[,<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb106-2"><a href="modelado.html#cb106-2" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> slogN[,<span class="dv">1</span>]</span></code></pre></div>
</div>
<div id="entrenamiento-de-la-red" class="section level3 hasAnchor" number="4.6.5">
<h3><span class="header-section-number">4.6.5</span> Entrenamiento de la red<a href="modelado.html#entrenamiento-de-la-red" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se entrena el modelo con la red de entrenamiento</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="modelado.html#cb107-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb107-2"><a href="modelado.html#cb107-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> fit<span class="ot">&lt;-</span><span class="fu">elman</span>(inputs[train],outputs[train],<span class="at">size=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>),<span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>),<span class="at">maxit=</span><span class="dv">64000</span>)</span></code></pre></div>
</div>
<div id="validación-y-ajuste-de-hiperparámetros" class="section level3 hasAnchor" number="4.6.6">
<h3><span class="header-section-number">4.6.6</span> Validación y ajuste de hiperparámetros<a href="modelado.html#validación-y-ajuste-de-hiperparámetros" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En la grafica siguiente vemos como evoluciona el error de la red con el numero de iteraciones para los parmetros expuestos</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="modelado.html#cb108-1" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit, <span class="at">main =</span> <span class="st">&quot;Iterative Error for 7,3 Neuron&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" />
### Evaluación del modelo</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="modelado.html#cb109-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb109-2"><a href="modelado.html#cb109-2" tabindex="-1"></a><span class="fu">plot</span>(y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb109-3"><a href="modelado.html#cb109-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>test])</span>
<span id="cb109-4"><a href="modelado.html#cb109-4" tabindex="-1"></a><span class="fu">lines</span>(pred,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Como podemos ver en la grafica de Real Vs Predicor para el test set, las red neuronal de El</p>
</div>
<div id="modelo-red-neuronal-de-jordan" class="section level3 hasAnchor" number="4.6.7">
<h3><span class="header-section-number">4.6.7</span> Modelo Red neuronal de Jordan<a href="modelado.html#modelo-red-neuronal-de-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En las redes Jordan, la diferencia esta en que la entrada de las neuronas de la capa de contexto se toma desde la salida de la red</p>
</div>
<div id="entrenamiento-del-modelo" class="section level3 hasAnchor" number="4.6.8">
<h3><span class="header-section-number">4.6.8</span> Entrenamiento del modelo<a href="modelado.html#entrenamiento-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="modelado.html#cb110-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb110-2"><a href="modelado.html#cb110-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span><span class="fu">jordan</span>(inputs[train],outputs[train],<span class="at">size=</span><span class="dv">6</span>,<span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>),<span class="at">maxit=</span><span class="dv">78000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="modelado.html#cb111-1" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit, <span class="at">main =</span> <span class="st">&quot;Iterative Error for 6 Neuron&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="modelado.html#cb112-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb112-2"><a href="modelado.html#cb112-2" tabindex="-1"></a><span class="fu">plot</span>(y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb112-3"><a href="modelado.html#cb112-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>test])</span>
<span id="cb112-4"><a href="modelado.html#cb112-4" tabindex="-1"></a><span class="fu">lines</span>(pred,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>El ajuste en esta red neuronal tambien es muy bueno, sin embargo, el modelo de Elman muestra visualmente un mejor ajuste.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="análisis-de-descriptivo-y-transformaciones.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/Desarrollo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
